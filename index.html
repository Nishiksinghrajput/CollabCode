<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="author" content="Bernie Perez">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collaborative Code Editor</title>
    <link rel="apple-touch-icon" sizes="57x57" href="/images/favicon/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/favicon/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/favicon/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/favicon/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/favicon/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/favicon/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/favicon/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/favicon/apple-touch-icon-152x152.png">
    <link rel="icon" type="image/png" sizes="196x196" href="/images/favicon/favicon-196x196.png">
    <link rel="icon" type="image/png" sizes="128x128" href="/images/favicon/favicon-128x128.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">

    <!-- styling -->
    <!-- Custom style -->
    <link rel="stylesheet" href="/styles/main.css">
    <!-- Firepad -->
    <link rel="stylesheet" href="https://cdn.firebase.com/libs/firepad/1.4.0/firepad.css" />

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- scripts -->
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/3.5.2/firebase.js"></script>
    <script src="/lib/firebase-sdk.js"></script>
    <!-- ACE and its JavaScript mode and theme files - Updated to latest -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.33.2/ace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.33.2/ext-language_tools.js"></script>
    <!-- Firepad -->
    <script src="https://cdn.firebase.com/libs/firepad/1.4.0/firepad.min.js"></script>
    <!-- Code Executor -->
    <script src="/scripts/code-executor.js"></script>
    <!-- Authentication -->
    <script src="/scripts/auth.js"></script>
  </head>
  <body>
    <!-- Landing Modal -->
    <div id="landingModal" class="modal">
      <div class="modal-content landing-content">
        <h2>Collaborative Code Editor</h2>
        <p class="subtitle">Interview Platform</p>
        
        <div class="role-selection">
          <div class="role-card" id="candidateCard">
            <div class="role-icon">ğŸ‘¨â€ğŸ’»</div>
            <h3>Join as Candidate</h3>
            <p>Join an interview session with a session code</p>
            <button class="role-btn candidate-btn">I'm a Candidate</button>
          </div>
          
          <div class="role-divider"></div>
          
          <div class="role-card" id="adminCard">
            <div class="role-icon">ğŸ‘”</div>
            <h3>Login as Interviewer</h3>
            <p>Create and manage interview sessions</p>
            <button class="role-btn admin-btn">I'm an Interviewer</button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Candidate Join Modal -->
    <div id="candidateModal" class="modal" style="display: none;">
      <div class="modal-content">
        <button class="back-btn" id="candidateBack">â† Back</button>
        <h2>Join Interview Session</h2>
        <p class="modal-subtitle">Enter your details to join the session</p>
        
        <div class="form-group">
          <label>Your Name</label>
          <input type="text" id="candidateName" placeholder="Enter your full name" maxlength="50">
        </div>
        
        <div class="form-group">
          <label>Session Code</label>
          <input type="text" id="candidateSessionCode" placeholder="6-digit code (e.g., 123456)" maxlength="6">
          <small>Your interviewer will provide this code</small>
        </div>
        
        <button id="candidateJoinBtn" class="primary-btn" disabled>Join Session</button>
      </div>
    </div>
    
    <!-- Admin Login Modal -->
    <div id="adminLoginModal" class="modal" style="display: none;">
      <div class="modal-content">
        <button class="back-btn" id="adminLoginBack">â† Back</button>
        <h2>Interviewer Login</h2>
        <p class="modal-subtitle">Login to create and manage sessions</p>
        
        <div class="form-group">
          <label>Email</label>
          <input type="email" id="adminEmail" placeholder="Enter your email">
        </div>
        
        <div class="form-group">
          <label>Password</label>
          <input type="password" id="adminPassword" placeholder="Enter your password">
        </div>
        
        <button id="adminLoginBtn" class="primary-btn">Login</button>
        <div id="loginError" class="error-message" style="display: none;"></div>
      </div>
    </div>
    
    <!-- Admin Dashboard Modal -->
    <div id="adminDashboardModal" class="modal" style="display: none;">
      <div class="modal-content">
        <div class="dashboard-header">
          <h2>Interviewer Dashboard</h2>
          <button id="adminLogoutBtn" class="logout-btn">Logout</button>
        </div>
        
        <div class="session-management">
          <h3>Session Management</h3>
          
          <div class="action-buttons">
            <button id="createSessionBtn" class="primary-btn">
              <span>+ Create New Session</span>
            </button>
            
            <div class="divider">
              <span>OR</span>
            </div>
            
            <div class="join-existing">
              <input type="text" id="adminSessionCode" placeholder="Enter session code" maxlength="6">
              <button id="adminJoinBtn" class="secondary-btn">Join Existing</button>
            </div>
          </div>
          
          <div id="activeSession" class="active-session" style="display: none;">
            <h4>Current Session</h4>
            <div class="session-info">
              <p>Session Code: <strong id="activeSessionCode"></strong></p>
              <button id="copyCodeBtn" class="copy-btn">Copy Code</button>
            </div>
          </div>
          
          <div class="admin-tools">
            <button id="viewAllSessionsBtn" class="secondary-btn" style="margin-top: 20px;">
              ğŸ“Š View All Active Sessions
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Sessions Management Modal -->
    <div id="sessionsModal" class="modal" style="display: none;">
      <div class="modal-content sessions-modal-content">
        <div class="modal-header">
          <h2>Sessions Management</h2>
          <button id="closeSessionsModalBtn" class="close-modal-btn">Ã—</button>
        </div>
        
        <div class="sessions-stats">
          <div class="stat-item">
            <span class="stat-label">Active Sessions:</span>
            <span id="activeSessionsCount" class="stat-value">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Total Users:</span>
            <span id="totalUsersCount" class="stat-value">0</span>
          </div>
        </div>
        
        <div class="session-tabs">
          <button id="activeTabBtn" class="tab-btn active">Active Sessions</button>
          <button id="archivedTabBtn" class="tab-btn">Archived (History)</button>
        </div>
        
        <div class="bulk-actions" id="bulkActionsBar">
          <button id="selectAllBtn" class="select-all-btn">Select All</button>
          <button id="endSelectedBtn" class="end-selected-btn" disabled>End Selected</button>
          <button id="endAllSessionsBtn" class="end-all-btn">End All Sessions</button>
        </div>
        
        <div id="sessionsTableContainer">
          <table id="sessionsTable" class="sessions-table">
            <thead>
              <tr>
                <th style="width: 40px;">
                  <input type="checkbox" id="selectAllCheckbox" title="Select All">
                </th>
                <th>Session Code</th>
                <th>Status</th>
                <th>Candidate</th>
                <th>All Participants</th>
                <th>Created</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="sessionsTableBody">
              <!-- Sessions will be populated here -->
            </tbody>
          </table>
          <div id="noSessionsMessage" class="no-sessions-message" style="display: none;">
            <p>No active sessions at the moment</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Main Editor Interface -->
    <div id="main-container" style="display: none;">
      <!-- Top Bar -->
      <div id="top-bar">
        <div class="left-controls">
          <select id="language-selector" title="Select Language">
            <optgroup label="Popular">
              <option value="javascript">ğŸŸ¨ JavaScript</option>
              <option value="python">ğŸ Python</option>
              <option value="java">â˜• Java</option>
              <option value="typescript">ğŸ”µ TypeScript</option>
              <option value="c_cpp">ğŸ”· C/C++</option>
            </optgroup>
            <optgroup label="Systems">
              <option value="go">ğŸ¹ Go</option>
              <option value="rust">ğŸ¦€ Rust</option>
              <option value="csharp">ğŸŸ¦ C#</option>
              <option value="swift">ğŸ Swift</option>
              <option value="kotlin">ğŸŸª Kotlin</option>
            </optgroup>
            <optgroup label="Scripting">
              <option value="ruby">ğŸ’ Ruby</option>
              <option value="php">ğŸ˜ PHP</option>
              <option value="perl">ğŸª Perl</option>
              <option value="lua">ğŸŒ™ Lua</option>
            </optgroup>
            <optgroup label="Functional">
              <option value="scala">ğŸ”´ Scala</option>
              <option value="haskell">ğŸ“ Haskell</option>
              <option value="elixir">ğŸ’§ Elixir</option>
            </optgroup>
            <optgroup label="Data & Stats">
              <option value="r">ğŸ“Š R</option>
              <option value="sql">ğŸ—„ï¸ SQL</option>
            </optgroup>
            <optgroup label="Mobile">
              <option value="dart">ğŸ¯ Dart</option>
              <option value="swift">ğŸ Swift</option>
              <option value="kotlin">ğŸŸª Kotlin</option>
            </optgroup>
            <optgroup label="Web">
              <option value="html">ğŸŒ HTML</option>
              <option value="css">ğŸ¨ CSS</option>
              <option value="javascript">ğŸŸ¨ JavaScript</option>
              <option value="typescript">ğŸ”µ TypeScript</option>
            </optgroup>
            <optgroup label="Config">
              <option value="json">ğŸ“‹ JSON</option>
              <option value="yaml">ğŸ“„ YAML</option>
              <option value="xml">ğŸ“° XML</option>
              <option value="markdown">ğŸ“ Markdown</option>
            </optgroup>
          </select>
          
          <select id="theme-selector">
            <option value="monokai">Monokai</option>
            <option value="github">GitHub</option>
            <option value="tomorrow">Tomorrow</option>
            <option value="twilight">Twilight</option>
            <option value="solarized_dark">Solarized Dark</option>
            <option value="solarized_light">Solarized Light</option>
            <option value="textmate">TextMate</option>
            <option value="terminal">Terminal</option>
          </select>

          <select id="fontSize-selector">
            <option value="12">12px</option>
            <option value="14" selected>14px</option>
            <option value="16">16px</option>
            <option value="18">18px</option>
            <option value="20">20px</option>
          </select>
        </div>

        <div class="center-info">
          <span id="session-info"></span>
          <button id="end-session-btn" class="end-session-button" style="margin-left: 15px;">End Interview</button>
          <span id="user-count" class="user-count"></span>
        </div>

        <div class="right-controls">
          <div id="users-list"></div>
          <button id="run-btn" class="run-button">â–¶ Run</button>
          <button id="share-btn">Share</button>
        </div>
      </div>

      <!-- Editor Container with Split View -->
      <div id="editor-wrapper">
        <div id="split-container">
          <div id="firepad-container"></div>
          <div id="output-panel" style="display: none;">
            <div id="output-header">
              <span>Output</span>
              <button id="clear-output">Clear</button>
              <button id="close-output">Ã—</button>
            </div>
            <div id="output-content">
              <pre id="output-text"></pre>
            </div>
            <div id="input-section" style="display: none;">
              <label>Input (stdin):</label>
              <textarea id="stdin-input" placeholder="Enter input for your program..."></textarea>
            </div>
          </div>
        </div>
      </div>

      <!-- Bottom Status Bar -->
      <div id="status-bar">
        <span id="cursor-position">Line 1, Column 1</span>
        <span id="connection-status" class="connected">Connected</span>
      </div>
    </div>

    <!-- Simple Templates (must load before firepad.js) -->
    <script src="/scripts/simple-templates.js"></script>
    <script src="/scripts/firepad.js"></script>
    <script src="/scripts/app.js"></script>
  </body>
</html>
